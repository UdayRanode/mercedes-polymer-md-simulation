# -------- Initialization --------
units           lj
atom_style      bond
boundary        p p p

read_data       data.lmp

# -------- Interactions (Kremer-Grest) --------
pair_style      lj/cut 1.12246
pair_modify     shift yes
pair_coeff      * * 1.0 1.0 1.12246

bond_style      fene
bond_coeff      1 30.0 1.5 1.0 1.0
special_bonds   fene

neighbor        0.6 bin
neigh_modify    delay 0 every 1 check yes

timestep        0.004

# -------- Thermostat / Dynamics --------
velocity        all create 1.0 ${SEED} mom yes rot yes dist gaussian
fix             TH all langevin 1.0 1.0 1.0 ${SEED}
fix             NVE all nve

# -------- Observables --------
compute         RG all gyration
thermo_style    custom step temp pe etotal c_RG
thermo          1000

# -------- Minimization --------
min_style       cg
minimize        1e-6 1e-8 10000 10000

# -------- Warm-up --------
pair_style      lj/cut 2.5
pair_coeff      * * 1.0 1.0 2.5
run             10000

# -------- Production Setup --------
pair_style      lj/cut 1.12246
pair_modify     shift yes
pair_coeff      * * 1.0 1.0 1.12246

reset_timestep  0

# Dump trajectory
dump            D all custom 1000 traj.lammpstrj id type x y z
# dump_modify     D bond yes   # Only valid with atom_style full or similar, REMOVE for bond-style "bond"
dump_modify     D sort id

# Record Rg^2
variable        s equal step
variable        rg equal c_RG
fix             OUT all print 1000 "${s} ${rg}" file rg2.dat screen no

# -------- Run Production --------
print           "BEGIN PRODUCTION: ${NSTEPS}"
run             ${NSTEPS}
print           "END PRODUCTION"

# -------- Cleanup --------
unfix           OUT
unfix           TH
undump          D
write_restart   restart.final
